"use strict";(()=>{var e={};e.id=41,e.ids=[41],e.modules={38013:e=>{e.exports=require("mongodb")},11185:e=>{e.exports=require("mongoose")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},624:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>w,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>y});var r={};n.r(r),n.d(r,{GET:()=>p});var a=n(49303),s=n(88716),i=n(60670),o=n(87070),u=n(75571),l=n(47944),d=n(75748),c=n(8473);async function p(e){try{let e=await (0,u.getServerSession)(l.L);if(!e?.user?.email)return o.NextResponse.json({message:"N\xe3o autorizado"},{status:401});await (0,d.u)();let t=e.user.id,n=await c.Z.countDocuments({userId:t}),r=new Date;r.setDate(1),r.setHours(0,0,0,0);let a=await c.Z.countDocuments({userId:t,createdAt:{$gte:r}});return o.NextResponse.json({totalReports:n,reportsThisMonth:a,averageScore:98,topIndustries:[{name:"Tecnologia",count:12},{name:"Com\xe9rcio",count:8},{name:"Log\xedstica",count:5}],monthlyReports:[{month:"Jan",count:2},{month:"Feb",count:4},{month:"Mar",count:6},{month:"Apr",count:8},{month:"May",count:10}]})}catch(e){return console.error("Erro ao carregar estat\xedsticas:",e),o.NextResponse.json({message:"Erro interno do servidor"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/dashboard/stats/route",pathname:"/api/dashboard/stats",filename:"route",bundlePath:"app/api/dashboard/stats/route"},resolvedPagePath:"C:\\Projects\\01 - Stratevo\\src\\app\\api\\dashboard\\stats\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:w,staticGenerationAsyncStorage:y,serverHooks:f}=m,g="/api/dashboard/stats/route";function h(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:y})}},41017:(e,t,n)=>{t.dJ=t.WU=t.c_=void 0;let r=n(38013);function a(e){return(null==e?void 0:e.length)!==24?new r.ObjectId:new r.ObjectId(e)}t.c_={Users:"users",Accounts:"accounts",Sessions:"sessions",VerificationTokens:"verification_tokens"},t.WU={from(e){let t={};for(let n in e){let r=e[n];"_id"===n?t.id=r.toHexString():"userId"===n?t[n]=r.toHexString():t[n]=r}return t},to(e){let t={_id:a(e.id)};for(let n in e){let r=e[n];if("userId"===n)t[n]=a(r);else{if("id"===n)continue;t[n]=r}}return t}},t.dJ=function(e,n={}){let{collections:s}=n,{from:i,to:o}=t.WU,u=(async()=>{let r=(await e).db(n.databaseName),a={...t.c_,...s};return{U:r.collection(a.Users),A:r.collection(a.Accounts),S:r.collection(a.Sessions),V:r.collection(null==a?void 0:a.VerificationTokens)}})();return{async createUser(e){let t=o(e);return await (await u).U.insertOne(t),i(t)},async getUser(e){let t=await (await u).U.findOne({_id:a(e)});return t?i(t):null},async getUserByEmail(e){let t=await (await u).U.findOne({email:e});return t?i(t):null},async getUserByAccount(e){let t=await (await u).A.findOne(e);if(!t)return null;let n=await (await u).U.findOne({_id:new r.ObjectId(t.userId)});return n?i(n):null},async updateUser(e){let{_id:t,...n}=o(e);return i((await (await u).U.findOneAndUpdate({_id:t},{$set:n},{returnDocument:"after"})).value)},async deleteUser(e){let t=a(e),n=await u;await Promise.all([n.A.deleteMany({userId:t}),n.S.deleteMany({userId:t}),n.U.deleteOne({_id:t})])},linkAccount:async e=>{let t=o(e);return await (await u).A.insertOne(t),t},async unlinkAccount(e){let{value:t}=await (await u).A.findOneAndDelete(e);return i(t)},async getSessionAndUser(e){let t=await (await u).S.findOne({sessionToken:e});if(!t)return null;let n=await (await u).U.findOne({_id:new r.ObjectId(t.userId)});return n?{user:i(n),session:i(t)}:null},async createSession(e){let t=o(e);return await (await u).S.insertOne(t),i(t)},async updateSession(e){let{_id:t,...n}=o(e);return i((await (await u).S.findOneAndUpdate({sessionToken:n.sessionToken},{$set:n},{returnDocument:"after"})).value)},async deleteSession(e){let{value:t}=await (await u).S.findOneAndDelete({sessionToken:e});return i(t)},createVerificationToken:async e=>(await (await u).V.insertOne(o(e)),e),async useVerificationToken(e){let{value:t}=await (await u).V.findOneAndDelete(e);return t?(delete t._id,t):null}}}},47944:(e,t,n)=>{let r;n.d(t,{L:()=>p});var a=n(77234),s=n(53797),i=n(41017),o=n(38013);if(!process.env.MONGODB_URI)throw Error('Invalid/Missing environment variable: "MONGODB_URI"');let u=process.env.MONGODB_URI;r=new o.MongoClient(u,{}).connect();var l=n(42023),d=n(75748),c=n(36713);let p={adapter:(0,i.dJ)(r),providers:[(0,a.Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET}),(0,s.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;await (0,d.u)();let t=await c.Z.findOne({email:e.email});return t&&t.password&&await (0,l.compare)(e.password,t.password)?{id:t._id.toString(),email:t.email,name:t.name,plan:t.plan}:null}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.plan=t.plan),e),session:async({session:e,token:t})=>(t&&(e.user.plan=t.plan),e)},pages:{signIn:"/auth/signin",signUp:"/auth/signup"}}},75748:(e,t,n)=>{n.d(t,{u:()=>o});var r=n(11185),a=n.n(r);let s=process.env.MONGODB_URI;if(!s)throw Error("Please define the MONGODB_URI environment variable inside .env.local");let i=global.mongoose;async function o(){if(i.conn)return i.conn;i.promise||(i.promise=a().connect(s,{bufferCommands:!1}).then(e=>e));try{i.conn=await i.promise}catch(e){throw i.promise=null,e}return i.conn}i||(i=global.mongoose={conn:null,promise:null})},8473:(e,t,n)=>{n.d(t,{Z:()=>i});var r=n(11185),a=n.n(r);let s=new(a()).Schema({userId:{type:a().Schema.Types.ObjectId,ref:"User",required:!0},companyName:{type:String,required:!0},cnpj:{type:String,required:!0},website:{type:String},data:{cadastral:{type:a().Schema.Types.Mixed,default:{}},financial:{type:a().Schema.Types.Mixed,default:{}},digital:{type:a().Schema.Types.Mixed,default:{}},commercial:{type:a().Schema.Types.Mixed,default:{}},supplyChain:{type:a().Schema.Types.Mixed,default:{}},news:{type:a().Schema.Types.Mixed,default:{}},swot:{type:a().Schema.Types.Mixed,default:{}}},status:{type:String,enum:["processing","completed","failed"],default:"processing"}},{timestamps:!0}),i=a().models.Report||a().model("Report",s)},36713:(e,t,n)=>{n.d(t,{Z:()=>o});var r=n(11185),a=n.n(r),s=n(42023);let i=new(a()).Schema({name:{type:String,required:!0},email:{type:String,required:!0,unique:!0},password:{type:String},plan:{type:String,enum:["freemium","standard","premium","pro","platinum"],default:"freemium"},reportsCount:{type:Number,default:0},reportsLimit:{type:Number,default:5}},{timestamps:!0});i.pre("save",async function(e){this.isModified("password")&&this.password&&(this.password=await (0,s.hash)(this.password,12)),e()}),i.pre("save",function(e){this.reportsLimit=({freemium:5,standard:50,premium:200,pro:500,platinum:-1})[this.plan],e()});let o=a().models.User||a().model("User",i)}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[276,972,23,734],()=>n(624));module.exports=r})();